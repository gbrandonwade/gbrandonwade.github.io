import React, { useState, useEffect } from 'react';
import { Search, Plus, Save, Copy, Share2, Tag, TestTube, Settings, ChevronRight, X, Edit, Trash2, Play, RefreshCw, Database, FileText, Zap, CheckCircle, AlertCircle, Menu } from 'lucide-react';

const PromptHub = () => {
  // State management
  const [activeTab, setActiveTab] = useState('build');
  const [prompts, setPrompts] = useState([]);
  const [contexts, setContexts] = useState([]);
  const [currentPrompt, setCurrentPrompt] = useState({
    id: null,
    title: 'Untitled Prompt',
    content: '',
    tags: [],
    notes: '',
    version: 1,
    contexts: []
  });
  const [searchQuery, setSearchQuery] = useState('');
  const [selectedBlocks, setSelectedBlocks] = useState([]);
  const [testResults, setTestResults] = useState([]);
  const [showShareModal, setShowShareModal] = useState(false);
  const [notification, setNotification] = useState(null);
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
  const [showBlocksPanel, setShowBlocksPanel] = useState(false);

  // Load data from localStorage on mount
  useEffect(() => {
    const savedPrompts = localStorage.getItem('prompthub_prompts');
    const savedContexts = localStorage.getItem('prompthub_contexts');
    if (savedPrompts) setPrompts(JSON.parse(savedPrompts));
    if (savedContexts) setContexts(JSON.parse(savedContexts));
  }, []);

  // Save data to localStorage
  useEffect(() => {
    localStorage.setItem('prompthub_prompts', JSON.stringify(prompts));
  }, [prompts]);

  useEffect(() => {
    localStorage.setItem('prompthub_contexts', JSON.stringify(contexts));
  }, [contexts]);

  // Prompt block templates
  const promptBlocks = [
    { id: 'role', label: 'Role Definition', template: 'You are an expert [FIELD] with deep knowledge in [SPECIALIZATION].' },
    { id: 'task', label: 'Task Description', template: 'Your task is to [ACTION] the following [INPUT TYPE]:' },
    { id: 'format', label: 'Output Format', template: 'Format your response as [FORMAT TYPE]. Include [REQUIRED ELEMENTS].' },
    { id: 'constraints', label: 'Constraints', template: 'Constraints:\n- [CONSTRAINT 1]\n- [CONSTRAINT 2]\n- [CONSTRAINT 3]' },
    { id: 'examples', label: 'Examples', template: 'Example Input: [INPUT]\nExample Output: [OUTPUT]' },
    { id: 'tone', label: 'Tone & Style', template: 'Use a [TONE] tone. Write in [STYLE] style suitable for [AUDIENCE].' },
    { id: 'steps', label: 'Step-by-Step', template: 'Follow these steps:\n1. [STEP 1]\n2. [STEP 2]\n3. [STEP 3]' },
    { id: 'context', label: 'Context Block', template: 'Context: [PROVIDE BACKGROUND INFORMATION]' },
    { id: 'json', label: 'JSON Output', template: 'Return the response in valid JSON format with the following structure:\n{\n  "field1": "value",\n  "field2": "value"\n}' },
    { id: 'reasoning', label: 'Chain of Thought', template: 'Think step-by-step and show your reasoning process before providing the final answer.' }
  ];

  // Show notification
  const showNotification = (message, type = 'success') => {
    setNotification({ message, type });
    setTimeout(() => setNotification(null), 3000);
  };

  // Add block to prompt
  const addBlockToPrompt = (block) => {
    const newContent = currentPrompt.content + (currentPrompt.content ? '\n\n' : '') + block.template;
    setCurrentPrompt({ ...currentPrompt, content: newContent });
    setSelectedBlocks([...selectedBlocks, block.id]);
    showNotification(`Added ${block.label} block`);
    // Close mobile panel after adding
    if (window.innerWidth < 1024) {
      setShowBlocksPanel(false);
    }
  };

  // Save prompt
  const savePrompt = () => {
    if (!currentPrompt.content.trim()) {
      showNotification('Please add some content to your prompt', 'error');
      return;
    }

    const promptToSave = {
      ...currentPrompt,
      id: currentPrompt.id || Date.now(),
      updatedAt: new Date().toISOString()
    };

    if (currentPrompt.id) {
      setPrompts(prompts.map(p => p.id === currentPrompt.id ? promptToSave : p));
    } else {
      setPrompts([...prompts, promptToSave]);
    }

    setCurrentPrompt(promptToSave);
    showNotification('Prompt saved successfully');
  };

  // Load prompt for editing
  const loadPrompt = (prompt) => {
    setCurrentPrompt(prompt);
    setActiveTab('build');
  };

  // Delete prompt
  const deletePrompt = (id) => {
    setPrompts(prompts.filter(p => p.id !== id));
    if (currentPrompt.id === id) {
      setCurrentPrompt({
        id: null,
        title: 'Untitled Prompt',
        content: '',
        tags: [],
        notes: '',
        version: 1,
        contexts: []
      });
    }
    showNotification('Prompt deleted');
  };

  // Test prompt (simulated)
  const testPrompt = () => {
    if (!currentPrompt.content) {
      showNotification('Please add content to test', 'error');
      return;
    }

    const models = ['GPT-4', 'Claude 3', 'Grok'];
    const simulatedResults = models.map(model => ({
      model,
      response: `[Simulated ${model} response]\n\nBased on your prompt:\n"${currentPrompt.content.substring(0, 100)}..."\n\nThis is a simulated response showing how ${model} would interpret and respond to your prompt. In a production environment, this would call the actual API.`,
      tokens: Math.floor(Math.random() * 500) + 100,
      latency: (Math.random() * 2 + 0.5).toFixed(2),
      score: Math.floor(Math.random() * 30) + 70
    }));

    setTestResults(simulatedResults);
    setActiveTab('test');
    showNotification('Test completed');
  };

  // Suggest fix for prompt
  const suggestFix = () => {
    const suggestions = [
      'Add more specific context about the expected output format',
      'Include examples to clarify the desired response style',
      'Define clear constraints to prevent unwanted behaviors',
      'Specify the target audience for better tone alignment',
      'Break down complex tasks into step-by-step instructions'
    ];

    const randomSuggestions = suggestions
      .sort(() => Math.random() - 0.5)
      .slice(0, 2)
      .join('\n\n• ');

    showNotification('Suggestions generated');
    alert(`Suggested improvements:\n\n• ${randomSuggestions}`);
  };

  // Save context snippet
  const saveContext = () => {
    const contextName = prompt('Enter a name for this context snippet:');
    if (contextName && currentPrompt.content) {
      const newContext = {
        id: Date.now(),
        name: contextName,
        content: currentPrompt.content,
        createdAt: new Date().toISOString()
      };
      setContexts([...contexts, newContext]);
      showNotification('Context snippet saved');
    }
  };

  // Filter prompts based on search
  const filteredPrompts = prompts.filter(p => 
    p.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
    p.content.toLowerCase().includes(searchQuery.toLowerCase()) ||
    p.tags.some(tag => tag.toLowerCase().includes(searchQuery.toLowerCase()))
  );

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-gray-100">
      {/* Header */}
      <header className="bg-gray-900/50 backdrop-blur-sm border-b border-gray-700/50 sticky top-0 z-40">
        <div className="px-4 py-3 sm:py-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center space-x-2 sm:space-x-3">
              <div className="p-1.5 sm:p-2 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg">
                <Zap className="w-5 h-5 sm:w-6 sm:h-6 text-white" />
              </div>
              <h1 className="text-xl sm:text-2xl font-bold bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent">
                PromptHub
              </h1>
            </div>
            <div className="flex items-center space-x-2 sm:space-x-4">
              <button className="p-1.5 sm:p-2 hover:bg-gray-700/50 rounded-lg transition-colors">
                <Settings className="w-4 h-4 sm:w-5 sm:h-5" />
              </button>
              <div className="hidden sm:block text-sm text-gray-400">
                {prompts.length} prompts • {contexts.length} contexts
              </div>
            </div>
          </div>
        </div>
      </header>

      {/* Navigation Tabs */}
      <div className="bg-gray-800/30 border-b border-gray-700/50 overflow-x-auto">
        <div className="px-4">
          <nav className="flex space-x-4 sm:space-x-8 min-w-max">
            {[
              { id: 'build', label: 'Build', icon: Edit },
              { id: 'vault', label: 'Vault', icon: Database },
              { id: 'test', label: 'Test', icon: TestTube },
              { id: 'context', label: 'Context', icon: FileText }
            ].map(tab => (
              <button
                key={tab.id}
                onClick={() => setActiveTab(tab.id)}
                className={`flex items-center space-x-1.5 sm:space-x-2 px-3 sm:px-4 py-2.5 sm:py-3 border-b-2 transition-all whitespace-nowrap ${
                  activeTab === tab.id
                    ? 'border-purple-500 text-purple-400'
                    : 'border-transparent text-gray-400 hover:text-gray-300'
                }`}
              >
                <tab.icon className="w-4 h-4" />
                <span className="text-sm sm:text-base">{tab.label}</span>
              </button>
            ))}
          </nav>
        </div>
      </div>

      {/* Main Content */}
      <main className="px-4 py-4 sm:py-6 max-w-7xl mx-auto">
        {/* Build Tab */}
        {activeTab === 'build' && (
          <div className="space-y-4">
            {/* Mobile Blocks Toggle Button */}
            <button
              onClick={() => setShowBlocksPanel(!showBlocksPanel)}
              className="lg:hidden w-full px-4 py-3 bg-purple-600 hover:bg-purple-700 rounded-lg flex items-center justify-center space-x-2 transition-colors"
            >
              <Plus className="w-4 h-4" />
              <span>Add Prompt Blocks</span>
            </button>

            {/* Mobile Blocks Panel */}
            {showBlocksPanel && (
              <div className="lg:hidden bg-gray-800/50 rounded-xl p-4 backdrop-blur-sm border border-gray-700/50">
                <div className="flex items-center justify-between mb-3">
                  <h3 className="text-base font-semibold">Prompt Blocks</h3>
                  <button
                    onClick={() => setShowBlocksPanel(false)}
                    className="p-1 hover:bg-gray-700 rounded transition-colors"
                  >
                    <X className="w-4 h-4" />
                  </button>
                </div>
                <div className="grid grid-cols-2 gap-2">
                  {promptBlocks.map(block => (
                    <button
                      key={block.id}
                      onClick={() => addBlockToPrompt(block)}
                      className="text-left px-3 py-2 bg-gray-700/30 hover:bg-gray-700/50 rounded-lg transition-all text-sm"
                    >
                      {block.label}
                    </button>
                  ))}
                </div>
              </div>
            )}

            <div className="grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-6">
              {/* Prompt Editor */}
              <div className="lg:col-span-2 space-y-4">
                <div className="bg-gray-800/50 rounded-xl p-4 sm:p-6 backdrop-blur-sm border border-gray-700/50">
                  <div className="space-y-3 sm:space-y-0 sm:flex sm:items-center sm:justify-between mb-4">
                    <input
                      type="text"
                      value={currentPrompt.title}
                      onChange={(e) => setCurrentPrompt({ ...currentPrompt, title: e.target.value })}
                      className="w-full sm:flex-1 text-lg sm:text-xl font-semibold bg-transparent border-b border-gray-600 focus:border-purple-500 outline-none pb-1"
                    />
                    <div className="flex space-x-2 sm:ml-4">
                      <button
                        onClick={savePrompt}
                        className="flex-1 sm:flex-initial px-3 sm:px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg flex items-center justify-center space-x-1.5 sm:space-x-2 transition-colors text-sm sm:text-base"
                      >
                        <Save className="w-4 h-4" />
                        <span>Save</span>
                      </button>
                      <button
                        onClick={testPrompt}
                        className="flex-1 sm:flex-initial px-3 sm:px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center justify-center space-x-1.5 sm:space-x-2 transition-colors text-sm sm:text-base"
                      >
                        <Play className="w-4 h-4" />
                        <span>Test</span>
                      </button>
                    </div>
                  </div>

                  <textarea
                    value={currentPrompt.content}
                    onChange={(e) => setCurrentPrompt({ ...currentPrompt, content: e.target.value })}
                    placeholder="Start building your prompt here..."
                    className="w-full h-64 sm:h-80 lg:h-96 bg-gray-900/50 rounded-lg p-3 sm:p-4 text-gray-100 placeholder-gray-500 border border-gray-700 focus:border-purple-500 outline-none resize-none font-mono text-xs sm:text-sm"
                  />

                  <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between mt-4 space-y-3 sm:space-y-0">
                    <div className="flex space-x-2 justify-center sm:justify-start">
                      <button
                        onClick={suggestFix}
                        className="px-2.5 sm:px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded-lg text-xs sm:text-sm flex items-center space-x-1 transition-colors"
                      >
                        <RefreshCw className="w-3 h-3" />
                        <span>Suggest Fix</span>
                      </button>
                      <button
                        onClick={saveContext}
                        className="px-2.5 sm:px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded-lg text-xs sm:text-sm flex items-center space-x-1 transition-colors"
                      >
                        <Database className="w-3 h-3" />
                        <span>Save Context</span>
                      </button>
                    </div>
                    <div className="text-xs sm:text-sm text-gray-400 text-center sm:text-right">
                      {currentPrompt.content.length} chars • v{currentPrompt.version}
                    </div>
                  </div>
                </div>

                {/* Tags and Notes */}
                <div className="bg-gray-800/50 rounded-xl p-4 sm:p-6 backdrop-blur-sm border border-gray-700/50">
                  <h3 className="text-base sm:text-lg font-semibold mb-3">Metadata</h3>
                  <div className="space-y-3 sm:space-y-4">
                    <div>
                      <label className="text-xs sm:text-sm text-gray-400 block mb-1">Tags</label>
                      <input
                        type="text"
                        placeholder="Add tags separated by commas"
                        value={currentPrompt.tags.join(', ')}
                        onChange={(e) => setCurrentPrompt({ 
                          ...currentPrompt, 
                          tags: e.target.value.split(',').map(t => t.trim()).filter(t => t)
                        })}
                        className="w-full bg-gray-900/50 rounded-lg px-3 py-2 text-xs sm:text-sm border border-gray-700 focus:border-purple-500 outline-none"
                      />
                    </div>
                    <div>
                      <label className="text-xs sm:text-sm text-gray-400 block mb-1">Notes</label>
                      <textarea
                        placeholder="Add notes about this prompt..."
                        value={currentPrompt.notes}
                        onChange={(e) => setCurrentPrompt({ ...currentPrompt, notes: e.target.value })}
                        className="w-full bg-gray-900/50 rounded-lg px-3 py-2 text-xs sm:text-sm border border-gray-700 focus:border-purple-500 outline-none resize-none h-16 sm:h-20"
                      />
                    </div>
                  </div>
                </div>
              </div>

              {/* Desktop Prompt Blocks - Hidden on Mobile */}
              <div className="hidden lg:block space-y-4">
                <div className="bg-gray-800/50 rounded-xl p-6 backdrop-blur-sm border border-gray-700/50">
                  <h3 className="text-lg font-semibold mb-4">Prompt Blocks</h3>
                  <div className="space-y-2">
                    {promptBlocks.map(block => (
                      <button
                        key={block.id}
                        onClick={() => addBlockToPrompt(block)}
                        className="w-full text-left px-4 py-3 bg-gray-700/30 hover:bg-gray-700/50 rounded-lg transition-all group"
                      >
                        <div className="flex items-center justify-between">
                          <span className="text-sm font-medium">{block.label}</span>
                          <Plus className="w-4 h-4 text-gray-500 group-hover:text-purple-400 transition-colors" />
                        </div>
                      </button>
                    ))}
                  </div>
                </div>

                {/* Context Snippets */}
                {contexts.length > 0 && (
                  <div className="bg-gray-800/50 rounded-xl p-6 backdrop-blur-sm border border-gray-700/50">
                    <h3 className="text-lg font-semibold mb-4">Context Snippets</h3>
                    <div className="space-y-2 max-h-64 overflow-y-auto">
                      {contexts.map(ctx => (
                        <button
                          key={ctx.id}
                          onClick={() => {
                            setCurrentPrompt({
                              ...currentPrompt,
                              content: currentPrompt.content + '\n\n' + ctx.content
                            });
                            showNotification('Context added');
                          }}
                          className="w-full text-left px-3 py-2 bg-gray-700/30 hover:bg-gray-700/50 rounded-lg text-sm transition-all"
                        >
                          {ctx.name}
                        </button>
                      ))}
                    </div>
                  </div>
                )}
              </div>
            </div>
          </div>
        )}

        {/* Vault Tab */}
        {activeTab === 'vault' && (
          <div className="space-y-4 sm:space-y-6">
            {/* Search Bar */}
            <div className="bg-gray-800/50 rounded-xl p-4 sm:p-6 backdrop-blur-sm border border-gray-700/50">
              <div className="relative">
                <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 sm:w-5 sm:h-5 text-gray-400" />
                <input
                  type="text"
                  placeholder="Search prompts..."
                  value={searchQuery}
                  onChange={(e) => setSearchQuery(e.target.value)}
                  className="w-full bg-gray-900/50 rounded-lg pl-9 sm:pl-10 pr-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-700 focus:border-purple-500 outline-none"
                />
              </div>
            </div>

            {/* Prompts Grid */}
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
              {filteredPrompts.map(prompt => (
                <div
                  key={prompt.id}
                  className="bg-gray-800/50 rounded-xl p-4 sm:p-5 backdrop-blur-sm border border-gray-700/50 hover:border-purple-500/50 transition-all"
                >
                  <div className="flex items-start justify-between mb-2 sm:mb-3">
                    <h3 className="font-semibold text-base sm:text-lg flex-1 mr-2">{prompt.title}</h3>
                    <div className="flex space-x-1">
                      <button
                        onClick={() => loadPrompt(prompt)}
                        className="p-1 sm:p-1.5 hover:bg-gray-700 rounded transition-colors"
                      >
                        <Edit className="w-3.5 h-3.5 sm:w-4 sm:h-4" />
                      </button>
                      <button
                        onClick={() => deletePrompt(prompt.id)}
                        className="p-1 sm:p-1.5 hover:bg-gray-700 rounded transition-colors text-red-400"
                      >
                        <Trash2 className="w-3.5 h-3.5 sm:w-4 sm:h-4" />
                      </button>
                    </div>
                  </div>
                  
                  <p className="text-xs sm:text-sm text-gray-400 mb-2 sm:mb-3 line-clamp-3">
                    {prompt.content}
                  </p>
                  
                  {prompt.tags.length > 0 && (
                    <div className="flex flex-wrap gap-1.5 sm:gap-2 mb-2 sm:mb-3">
                      {prompt.tags.map((tag, idx) => (
                        <span
                          key={idx}
                          className="px-1.5 sm:px-2 py-0.5 sm:py-1 bg-purple-500/20 text-purple-400 rounded text-xs"
                        >
                          {tag}
                        </span>
                      ))}
                    </div>
                  )}
                  
                  <div className="flex items-center justify-between text-xs text-gray-500">
                    <span>v{prompt.version}</span>
                    <button
                      onClick={() => {
                        navigator.clipboard.writeText(prompt.content);
                        showNotification('Copied to clipboard');
                      }}
                      className="flex items-center space-x-1 hover:text-gray-300 transition-colors"
                    >
                      <Copy className="w-3 h-3" />
                      <span>Copy</span>
                    </button>
                  </div>
                </div>
              ))}
            </div>

            {filteredPrompts.length === 0 && (
              <div className="text-center py-8 sm:py-12 text-gray-500">
                <Database className="w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-3 opacity-50" />
                <p className="text-sm sm:text-base">No prompts found</p>
              </div>
            )}
          </div>
        )}

        {/* Test Tab */}
        {activeTab === 'test' && (
          <div className="space-y-4 sm:space-y-6">
            {/* Test Controls */}
            <div className="bg-gray-800/50 rounded-xl p-4 sm:p-6 backdrop-blur-sm border border-gray-700/50">
              <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0">
                <div>
                  <h3 className="text-base sm:text-lg font-semibold mb-1 sm:mb-2">Test Bench</h3>
                  <p className="text-xs sm:text-sm text-gray-400">Compare prompt performance across models</p>
                </div>
                <button
                  onClick={testPrompt}
                  className="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg flex items-center justify-center space-x-2 transition-colors text-sm sm:text-base"
                >
                  <Play className="w-4 h-4" />
                  <span>Run Test</span>
                </button>
              </div>
            </div>

            {/* Test Results */}
            {testResults.length > 0 && (
              <div className="grid grid-cols-1 lg:grid-cols-3 gap-3 sm:gap-4">
                {testResults.map((result, idx) => (
                  <div
                    key={idx}
                    className="bg-gray-800/50 rounded-xl p-4 sm:p-5 backdrop-blur-sm border border-gray-700/50"
                  >
                    <div className="flex items-center justify-between mb-2 sm:mb-3">
                      <h4 className="font-semibold text-base sm:text-lg">{result.model}</h4>
                      <div className="flex items-center space-x-1">
                        <CheckCircle className="w-3.5 h-3.5 sm:w-4 sm:h-4 text-green-400" />
                        <span className="text-xs sm:text-sm text-green-400">{result.score}%</span>
                      </div>
                    </div>
                    
                    <div className="bg-gray-900/50 rounded-lg p-2.5 sm:p-3 mb-2 sm:mb-3 max-h-36 sm:max-h-48 overflow-y-auto">
                      <p className="text-xs sm:text-sm text-gray-300 font-mono whitespace-pre-wrap">
                        {result.response}
                      </p>
                    </div>
                    
                    <div className="grid grid-cols-2 gap-2 sm:gap-3 text-xs">
                      <div className="bg-gray-900/30 rounded px-2 py-1">
                        <span className="text-gray-500">Tokens:</span>
                        <span className="ml-1 text-gray-300">{result.tokens}</span>
                      </div>
                      <div className="bg-gray-900/30 rounded px-2 py-1">
                        <span className="text-gray-500">Latency:</span>
                        <span className="ml-1 text-gray-300">{result.latency}s</span>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            )}

            {testResults.length === 0 && (
              <div className="text-center py-8 sm:py-12 text-gray-500">
                <TestTube className="w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-3 opacity-50" />
                <p className="text-sm sm:text-base">No test results yet</p>
                <p className="text-xs sm:text-sm mt-1">Run a test to compare model outputs</p>
              </div>
            )}
          </div>
        )}

        {/* Context Tab */}
        {activeTab === 'context' && (
          <div className="space-y-4 sm:space-y-6">
            <div className="bg-gray-800/50 rounded-xl p-4 sm:p-6 backdrop-blur-sm border border-gray-700/50">
              <h3 className="text-base sm:text-lg font-semibold mb-3 sm:mb-4">Context Manager</h3>
              <p className="text-xs sm:text-sm text-gray-400 mb-4 sm:mb-6">
                Save and manage reusable context snippets to reduce token usage
              </p>
              
              {contexts.length > 0 ? (
                <div className="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4">
                  {contexts.map(ctx => (
                    <div
                      key={ctx.id}
                      className="bg-gray-900/50 rounded-lg p-3 sm:p-4 border border-gray-700"
                    >
                      <div className="flex items-center justify-between mb-2">
                        <h4 className="font-medium text-sm sm:text-base">{ctx.name}</h4>
                        <button
                          onClick={() => {
                            setContexts(contexts.filter(c => c.id !== ctx.id));
                            showNotification('Context deleted');
                          }}
                          className="p-1 hover:bg-gray-700 rounded transition-colors text-red-400"
                        >
                          <X className="w-3.5 h-3.5 sm:w-4 sm:h-4" />
                        </button>
                      </div>
                      <p className="text-xs sm:text-sm text-gray-400 line-clamp-2 mb-2">{ctx.content}</p>
                      <div className="flex items-center justify-between text-xs text-gray-500">
                        <span>{new Date(ctx.createdAt).toLocaleDateString()}</span>
                        <button
                          onClick={() => {
                            navigator.clipboard.writeText(ctx.content);
                            showNotification('Copied to clipboard');
                          }}
                          className="flex items-center space-x-1 hover:text-gray-300 transition-colors"
                        >
                          <Copy className="w-3 h-3" />
                          <span>Copy</span>
                        </button>
                      </div>
                    </div>
                  ))}
                </div>
              ) : (
                <div className="text-center py-6 sm:py-8 text-gray-500">
                  <FileText className="w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-3 opacity-50" />
                  <p className="text-sm sm:text-base">No context snippets saved</p>
                  <p className="text-xs sm:text-sm mt-1">Save contexts from the Build tab</p>
                </div>
              )}
            </div>
          </div>
        )}
      </main>

      {/* Notification */}
      {notification && (
        <div className={`fixed bottom-4 right-4 left-4 sm:left-auto sm:max-w-sm px-3 sm:px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2 transition-all transform ${
          notification.type === 'error' ? 'bg-red-600' : 'bg-green-600'
        }`}>
          {notification.type === 'error' ? (
            <AlertCircle className="w-4 h-4 flex-shrink-0" />
          ) : (
            <CheckCircle className="w-4 h-4 flex-shrink-0" />
          )}
          <span className="text-xs sm:text-sm">{notification.message}</span>
        </div>
      )}
    </div>
  );
};

export default PromptHub;
