<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Prompt Builder</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #34495e;
            --accent-color: #e67e22;
            --success-color: #27ae60;
            --background: #fafbfc;
            --surface: #ffffff;
            --text-primary: #2c3e50;
            --text-secondary: #5a6c7d;
            --text-muted: #8495a7;
            --border: #e1e8ed;
            --border-light: #f0f3f6;
            --shadow: 0 2px 8px rgba(44, 62, 80, 0.08);
            --shadow-large: 0 4px 24px rgba(44, 62, 80, 0.12);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 48px;
            padding: 32px 0;
        }

        .logo {
            font-size: 2rem;
            font-weight: 700;
            color: #34495e;
            margin-bottom: 8px;
        }

        .tagline {
            font-size: 1.1rem;
            color: #7f8c8d;
            font-weight: 400;
        }

        .card {
            background: var(--surface);
            border-radius: 12px;
            padding: 32px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-light);
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        /* Welcome Screen */
        .welcome-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-top: 32px;
        }

        .option-card {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 32px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            color: inherit;
        }

        .option-card:hover {
            border-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-large);
        }

        .option-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--primary-color);
        }

        .option-description {
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* Template Selection */
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 24px;
        }

        .template-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .template-card:hover {
            border-color: var(--accent-color);
            box-shadow: var(--shadow);
        }

        .template-card.selected {
            border-color: var(--accent-color);
            background: #fff5f0;
        }

        /* Complexity Selection */
        .complexity-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-top: 32px;
        }

        .complexity-card {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .complexity-card:hover {
            border-color: var(--accent-color);
            transform: translateY(-2px);
        }

        .complexity-card.selected {
            border-color: var(--accent-color);
            background: #fff5f0;
        }

        .complexity-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary-color);
        }

        .complexity-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 12px;
        }

        .complexity-elements {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        /* Builder Interface */
        .builder-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            align-items: start;
        }

        .builder-form {
            background: var(--surface);
            border-radius: 12px;
            padding: 32px;
            box-shadow: var(--shadow);
        }

        .preview-panel {
            background: var(--surface);
            border-radius: 12px;
            padding: 32px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 20px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.2s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(230, 126, 34, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .help-text {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            background: #d35400;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--border);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: #d5dbdb;
        }

        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .preview-content {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 24px;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            line-height: 1.5;
            white-space: pre-wrap;
            overflow-x: auto;
            max-height: 600px;
            overflow-y: auto;
        }

        .export-section {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
        }

        .progress-bar {
            background: var(--border-light);
            height: 4px;
            border-radius: 2px;
            margin-bottom: 24px;
            overflow: hidden;
        }

        .progress-fill {
            background: var(--accent-color);
            height: 100%;
            transition: width 0.3s ease;
        }

        @media (max-width: 768px) {
            .welcome-options {
                grid-template-columns: 1fr;
            }
            
            .builder-container {
                grid-template-columns: 1fr;
            }
            
            .preview-panel {
                position: relative;
                order: -1;
            }
            
            .complexity-options {
                grid-template-columns: 1fr;
            }
        }

        .back-btn {
            margin-bottom: 24px;
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .back-btn:hover {
            background: var(--border-light);
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">Claude Prompt Builder</div>
            <div class="tagline">Create professional, effective prompts with guided templates</div>
        </header>

        <!-- Welcome Screen -->
        <div id="welcome-screen" class="screen active">
            <div class="card">
                <h2 style="text-align: center; margin-bottom: 32px; color: var(--text-primary);">How would you like to start?</h2>
                <div class="welcome-options">
                    <div class="option-card" onclick="showTemplateSelection()">
                        <div class="option-title">Choose from Templates</div>
                        <div class="option-description">Start with pre-built templates optimized for specific use cases like marketing, technical writing, or analysis</div>
                    </div>
                    <div class="option-card" onclick="showComplexitySelection()">
                        <div class="option-title">Start from Scratch</div>
                        <div class="option-description">Build your prompt step-by-step with full control over every element and customization</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template Selection Screen -->
        <div id="template-screen" class="screen">
            <div class="card">
                <button class="btn back-btn" onclick="showWelcome()">‚Üê Back</button>
                <h2 style="margin-bottom: 24px;">Choose a Template</h2>
                <div class="template-grid" id="template-grid">
                    <!-- Templates will be populated by JavaScript -->
                </div>
                <div class="btn-group">
                    <button class="btn" onclick="startBuilderFromTemplate()" id="template-continue-btn" disabled>Continue with Selected Template</button>
                </div>
            </div>
        </div>

        <!-- Complexity Selection Screen -->
        <div id="complexity-screen" class="screen">
            <div class="card">
                <button class="btn back-btn" onclick="showWelcome()">‚Üê Back</button>
                <h2 style="margin-bottom: 24px;">Choose Your Builder Type</h2>
                <div class="complexity-options" id="complexity-options">
                    <!-- Complexity options will be populated by JavaScript -->
                </div>
                <div class="btn-group">
                    <button class="btn" onclick="startBuilderFromScratch()" id="complexity-continue-btn" disabled>Start Building</button>
                </div>
            </div>
        </div>

        <!-- Builder Screen -->
        <div id="builder-screen" class="screen">
            <button class="btn back-btn" onclick="goBack()">‚Üê Back</button>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="builder-container">
                <div class="builder-form">
                    <h2 id="builder-title">Build Your Prompt</h2>
                    <form id="prompt-form">
                        <!-- Form fields will be populated by JavaScript -->
                    </form>
                </div>
                <div class="preview-panel">
                    <h3 style="margin-bottom: 16px;">Live Preview</h3>
                    <div class="preview-content" id="preview-content">Your prompt will appear here as you fill out the form...</div>
                    <div class="export-section">
                        <h4 style="margin-bottom: 12px;">Export Your Prompt</h4>
                        <div class="btn-group">
                            <button class="btn" onclick="copyToClipboard()">Copy to Clipboard</button>
                            <button class="btn btn-secondary" onclick="downloadMarkdown()">Download Markdown</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentComplexity = '';
        let currentTemplate = null;
        let currentStep = 0;
        let formData = {};
        let fromTemplate = false;

        // Template definitions
        const templates = {
            marketing: {
                name: "Marketing & Copywriting",
                description: "Email campaigns, product descriptions, social media content",
                preset: {
                    role: "experienced marketing copywriter specializing in conversion-focused content",
                    task: "write compelling copy that drives engagement and conversions",
                    context: "Target audience: [describe your audience]\nProduct/Service: [describe what you're promoting]\nChannel: [email, social media, website, etc.]\nGoal: [specific objective like increase CTR, drive sales, etc.]"
                }
            },
            technical: {
                name: "Technical Documentation",
                description: "API docs, user guides, technical tutorials",
                preset: {
                    role: "senior technical writer with expertise in developer documentation",
                    task: "create clear, comprehensive technical documentation",
                    context: "Audience: [developers, end users, administrators, etc.]\nProduct: [software, API, tool, etc.]\nComplexity level: [beginner, intermediate, advanced]\nFormat: [tutorial, reference, guide, etc.]"
                }
            },
            analysis: {
                name: "Data Analysis & Research",
                description: "Market research, data interpretation, strategic analysis",
                preset: {
                    role: "senior business analyst with expertise in data interpretation and strategic insights",
                    task: "analyze data and provide actionable business insights",
                    context: "Industry: [your industry]\nData type: [sales, market, customer, etc.]\nStakeholders: [executives, managers, team members]\nDecision context: [what decision needs to be made]"
                }
            },
            creative: {
                name: "Creative Writing",
                description: "Blog posts, stories, creative content",
                preset: {
                    role: "experienced creative writer with a strong voice and storytelling ability",
                    task: "create engaging, original content that captivates readers",
                    context: "Content type: [blog post, story, article, etc.]\nTone: [professional, casual, humorous, etc.]\nAudience: [describe your readers]\nPurpose: [inform, entertain, persuade, etc.]"
                }
            },
            support: {
                name: "Customer Support",
                description: "Help documentation, FAQ responses, support scripts",
                preset: {
                    role: "experienced customer support specialist focused on clear, helpful communication",
                    task: "provide helpful, empathetic customer support responses",
                    context: "Product/Service: [what you support]\nCustomer type: [new users, existing customers, etc.]\nIssue type: [technical, billing, general inquiry, etc.]\nChannel: [email, chat, phone script, etc.]"
                }
            },
            strategy: {
                name: "Strategic Planning",
                description: "Business plans, strategic recommendations, decision frameworks",
                preset: {
                    role: "senior strategy consultant with expertise in business planning and decision-making frameworks",
                    task: "develop strategic recommendations and actionable plans",
                    context: "Company stage: [startup, growth, enterprise]\nIndustry: [your industry]\nTimeframe: [quarterly, annual, long-term]\nKey challenge: [specific business challenge]"
                }
            }
        };

        // Complexity levels
        const complexityLevels = {
            quick: {
                title: "Quick Builder",
                description: "Essential elements for simple tasks",
                elements: "Role, Task, Context, Instructions, Format",
                fields: ['role', 'task', 'context', 'instructions', 'format']
            },
            standard: {
                title: "Standard Builder", 
                description: "Comprehensive prompts for most use cases",
                elements: "Role, Task, Context, Instructions, Format, Examples, Success Criteria",
                fields: ['role', 'task', 'context', 'instructions', 'format', 'examples', 'success_criteria']
            },
            advanced: {
                title: "Advanced Builder",
                description: "Full template with all optimization features",
                elements: "All 10 elements including thinking process and variables",
                fields: ['role', 'task', 'context', 'instructions', 'format', 'examples', 'thinking', 'success_criteria', 'variables', 'final_instructions']
            }
        };

        // Field definitions
        const fieldDefinitions = {
            role: {
                label: "Role/Persona",
                type: "input",
                placeholder: "e.g., senior marketing manager with 10 years of B2B experience",
                help: "Define the expert persona Claude should adopt"
            },
            task: {
                label: "Task Definition", 
                type: "input",
                placeholder: "e.g., write a compelling email subject line that increases open rates",
                help: "Specify exactly what you want Claude to accomplish"
            },
            context: {
                label: "Context & Background",
                type: "textarea",
                placeholder: "Target audience: [describe audience]\nGoals: [specific objectives]\nConstraints: [any limitations]",
                help: "Provide relevant background information"
            },
            instructions: {
                label: "Specific Instructions",
                type: "textarea", 
                placeholder: "- Keep under 50 characters\n- Use active voice\n- Include emotional appeal\n- Avoid spam trigger words",
                help: "List specific guidelines and constraints"
            },
            format: {
                label: "Output Format",
                type: "textarea",
                placeholder: "Provide 3 options in this format:\nOption 1: [content]\nRationale: [explanation]",
                help: "Specify how the response should be structured"
            },
            examples: {
                label: "Examples",
                type: "textarea",
                placeholder: "Example 1:\nInput: [sample]\nOutput: [desired result]\n\nExample 2:\nInput: [sample]\nOutput: [desired result]",
                help: "Show Claude 2-3 examples of good outputs"
            },
            thinking: {
                label: "Thinking Process", 
                type: "textarea",
                placeholder: "Before responding, think through:\n1. [analysis step]\n2. [consideration step]\n3. [decision step]",
                help: "Guide Claude through step-by-step reasoning"
            },
            success_criteria: {
                label: "Success Criteria",
                type: "textarea",
                placeholder: "Your response will be successful if it:\n- [measurable criterion 1]\n- [measurable criterion 2]\n- [measurable criterion 3]",
                help: "Define what makes a successful response"
            },
            variables: {
                label: "Variables",
                type: "textarea",
                placeholder: "{{COMPANY_NAME}}: The company being analyzed\n{{TIMEFRAME}}: Analysis period (e.g., Q4 2024)",
                help: "Define reusable template variables"
            },
            final_instructions: {
                label: "Final Instructions",
                type: "textarea",
                placeholder: "Present your response as:\n- [format requirement]\n- [tone requirement]\n\nDo not include disclaimers or requests for more information.",
                help: "Final delivery and formatting requirements"
            }
        };

        // Show different screens
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function showWelcome() {
            showScreen('welcome-screen');
        }

        function showTemplateSelection() {
            populateTemplates();
            showScreen('template-screen');
        }

        function showComplexitySelection() {
            populateComplexityOptions();
            showScreen('complexity-screen');
        }

        function populateTemplates() {
            const grid = document.getElementById('template-grid');
            grid.innerHTML = '';
            
            Object.entries(templates).forEach(([key, template]) => {
                const card = document.createElement('div');
                card.className = 'template-card';
                card.dataset.template = key;
                card.onclick = (e) => selectTemplate(key, card);
                card.innerHTML = `
                    <h3 style="margin-bottom: 8px; color: var(--primary-color);">${template.name}</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">${template.description}</p>
                `;
                grid.appendChild(card);
            });
        }

        function populateComplexityOptions() {
            const container = document.getElementById('complexity-options');
            container.innerHTML = '';
            
            Object.entries(complexityLevels).forEach(([key, level]) => {
                const card = document.createElement('div');
                card.className = 'complexity-card';
                card.dataset.complexity = key;
                card.onclick = (e) => selectComplexity(key, card);
                card.innerHTML = `
                    <div class="complexity-title">${level.title}</div>
                    <div class="complexity-description">${level.description}</div>
                    <div class="complexity-elements">${level.elements}</div>
                `;
                container.appendChild(card);
            });
        }

        function selectTemplate(templateKey, cardElement) {
            // Remove previous selection
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Select current
            cardElement.classList.add('selected');
            currentTemplate = templateKey;
            document.getElementById('template-continue-btn').disabled = false;
        }

        function selectComplexity(complexityKey, cardElement) {
            // Remove previous selection
            document.querySelectorAll('.complexity-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Select current
            cardElement.classList.add('selected');
            currentComplexity = complexityKey;
            document.getElementById('complexity-continue-btn').disabled = false;
        }

        function startBuilderFromTemplate() {
            fromTemplate = true;
            // Default to standard complexity for templates
            currentComplexity = 'standard';
            initializeBuilder();
        }

        function startBuilderFromScratch() {
            fromTemplate = false;
            currentTemplate = null;
            initializeBuilder();
        }

        function initializeBuilder() {
            showScreen('builder-screen');
            populateForm();
            if (currentTemplate && fromTemplate) {
                prefillTemplate();
            }
            updatePreview();
        }

        function populateForm() {
            const form = document.getElementById('prompt-form');
            const fields = complexityLevels[currentComplexity].fields;
            
            form.innerHTML = '';
            
            fields.forEach(fieldKey => {
                const field = fieldDefinitions[fieldKey];
                const formGroup = document.createElement('div');
                formGroup.className = 'form-group';
                
                const inputId = `field-${fieldKey}`;
                const inputElement = field.type === 'textarea' ? 'textarea' : 'input';
                
                formGroup.innerHTML = `
                    <label for="${inputId}">${field.label}</label>
                    <${inputElement} 
                        id="${inputId}" 
                        name="${fieldKey}"
                        placeholder="${field.placeholder}"
                        ${field.type === 'input' ? 'type="text"' : ''}
                    ></${inputElement}>
                    <div class="help-text">${field.help}</div>
                `;
                
                form.appendChild(formGroup);
                
                // Add event listener for real-time preview
                const input = formGroup.querySelector(`${inputElement}`);
                input.addEventListener('input', updatePreview);
            });
        }

        function prefillTemplate() {
            const template = templates[currentTemplate];
            if (template && template.preset) {
                Object.entries(template.preset).forEach(([key, value]) => {
                    const input = document.getElementById(`field-${key}`);
                    if (input) {
                        input.value = value;
                    }
                });
            }
        }

        function updatePreview() {
            const fields = complexityLevels[currentComplexity].fields;
            let prompt = '';
            
            fields.forEach(fieldKey => {
                const input = document.getElementById(`field-${fieldKey}`);
                const value = input ? input.value.trim() : '';
                
                if (value) {
                    switch(fieldKey) {
                        case 'role':
                            prompt += `You are a ${value}.\n\n`;
                            break;
                        case 'task':
                            prompt += `Your task is to ${value}.\n\n`;
                            break;
                        case 'context':
                            prompt += `<context>\n${value}\n</context>\n\n`;
                            break;
                        case 'instructions':
                            prompt += `Please follow these specific guidelines:\n${value}\n\n`;
                            break;
                        case 'format':
                            prompt += `<format>\n${value}\n</format>\n\n`;
                            break;
                        case 'examples':
                            prompt += `<examples>\n${value}\n</examples>\n\n`;
                            break;
                        case 'thinking':
                            prompt += `Before providing your final answer, think through this step-by-step:\n<thinking>\n${value}\n</thinking>\n\nThen provide your final response.\n\n`;
                            break;
                        case 'success_criteria':
                            prompt += `<success_criteria>\n${value}\n</success_criteria>\n\n`;
                            break;
                        case 'variables':
                            prompt += `<variables>\n${value}\n</variables>\n\n`;
                            break;
                        case 'final_instructions':
                            prompt += `${value}`;
                            break;
                    }
                }
            });
            
            const preview = document.getElementById('preview-content');
            preview.textContent = prompt || 'Your prompt will appear here as you fill out the form...';
            
            // Update progress
            const filledFields = fields.filter(fieldKey => {
                const input = document.getElementById(`field-${fieldKey}`);
                return input && input.value.trim();
            }).length;
            
            const progress = (filledFields / fields.length) * 100;
            document.getElementById('progress-fill').style.width = `${progress}%`;
        }

        function goBack() {
            if (fromTemplate) {
                showTemplateSelection();
            } else {
                showComplexitySelection();
            }
        }

        function copyToClipboard() {
            const preview = document.getElementById('preview-content');
            const text = preview.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                // Visual feedback
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                btn.style.background = 'var(--success-color)';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = 'var(--accent-color)';
                }, 2000);
            });
        }

        function downloadMarkdown() {
            const preview = document.getElementById('preview-content');
            const content = preview.textContent;
            
            const markdownContent = `# Claude Prompt\n\nGenerated by Claude Prompt Builder\n\n## Prompt\n\n\`\`\`\n${content}\n\`\`\`\n\n## Usage Instructions\n\n1. Copy the prompt above\n2. Paste it into your Claude conversation\n3. Replace any variables (in {{brackets}}) with your specific information\n4. Send to Claude and review the output\n\n---\n\n*Created with [Claude Prompt Builder]()*`;
            
            const blob = new Blob([markdownContent], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'claude-prompt.md';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
// Add these new functions to your prompt builder JavaScript:

function checkForPresetData() {
    const urlParams = new URLSearchParams(window.location.search);
    
    if (urlParams.get('preset') === 'true') {
        // We have preset data from the prompt library
        const presetData = {
            title: urlParams.get('title') || '',
            category: urlParams.get('category') || '',
            difficulty: urlParams.get('difficulty') || 'standard',
            description: urlParams.get('description') || '',
            content: urlParams.get('content') || '',
            tags: urlParams.get('tags') ? urlParams.get('tags').split(',') : [],
            useCases: urlParams.get('useCases') ? urlParams.get('useCases').split(',') : []
        };
        
        // Show notification about the import
        showImportNotification(presetData.title);
        
        // Auto-start with standard complexity
        setTimeout(() => {
            fromTemplate = false;
            currentComplexity = 'standard';
            initializeBuilder();
            
            // Pre-fill the form after it's created
            setTimeout(() => {
                prefillFromPromptLibrary(presetData);
            }, 300);
        }, 100);
    }
}

function prefillFromPromptLibrary(data) {
    // Smart content parsing for better field distribution
    const content = data.content;
    
    // Extract role
    const roleField = document.getElementById('field-role');
    if (roleField) {
        const rolePatterns = [
            /You are (?:a |an )?([^.]+)/i,
            /Role: ([^.]+)/i,
            /Act as (?:a |an )?([^.]+)/i,
            /Assume the role of ([^.]+)/i
        ];
        
        let roleText = 'professional AI assistant';
        for (const pattern of rolePatterns) {
            const match = content.match(pattern);
            if (match) {
                roleText = match[1].trim();
                break;
            }
        }
        roleField.value = roleText;
    }
    
    // Extract task
    const taskField = document.getElementById('field-task');
    if (taskField) {
        const taskPatterns = [
            /Task: ([^.]+(?:\.[^.]*)?)/i,
            /Your task is to ([^.]+)/i,
            /Your clear task is to ([^.]+)/i
        ];
        
        let taskText = `Customize and improve this ${data.category} prompt: ${data.title}`;
        for (const pattern of taskPatterns) {
            const match = content.match(pattern);
            if (match) {
                taskText = match[1].trim();
                break;
            }
        }
        taskField.value = taskText;
    }
    
    // Extract context/background
    const contextField = document.getElementById('field-context');
    if (contextField) {
        const contextPatterns = [
            /Context: ([^.]+(?:\.[^.]*)*)/i,
            /Background: ([^.]+(?:\.[^.]*)*)/i
        ];
        
        let contextText = `Original prompt: ${data.title}\nCategory: ${data.category}\nDifficulty: ${data.difficulty}\n\nDescription: ${data.description}`;
        for (const pattern of contextPatterns) {
            const match = content.match(pattern);
            if (match) {
                contextText = match[1].trim();
                break;
            }
        }
        contextField.value = contextText;
    }
    
    // Put remaining content in instructions
    const instructionsField = document.getElementById('field-instructions');
    if (instructionsField) {
        // Clean up the content by removing the parts we've already extracted
        let instructions = content
            .replace(/You are (?:a |an )?[^.]+\./i, '')
            .replace(/Task: [^.]+(?:\.[^.]*)?/i, '')
            .replace(/Context: [^.]+(?:\.[^.]*)*/i, '')
            .replace(/Background: [^.]+(?:\.[^.]*)*/i, '')
            .trim();
        
        instructionsField.value = instructions || content;
    }
    
    // Add tags as format guidance
    const formatField = document.getElementById('field-format');
    if (formatField && data.tags.length > 0) {
        formatField.value = `Focus areas: ${data.tags.join(', ')}\n\nTarget users: ${data.useCases.join(', ')}`;
    }
    
    // Update the preview
    updatePreview();

}

function showImportNotification(promptTitle) {
    // Create a more polished notification
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #e67e22, #d35400);
        color: white;
        padding: 1.2rem 1.8rem;
        border-radius: 12px;
        font-weight: 600;
        z-index: 1000;
        box-shadow: 0 8px 32px rgba(230, 126, 34, 0.4);
        max-width: 350px;
        border: 2px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        animation: slideInRight 0.4s ease;
    `;
    notification.innerHTML = `
        <div style="display: flex; align-items: center; gap: 0.8rem;">
            <div style="font-size: 1.5rem;">üéØ</div>
            <div>
                <div style="font-size: 0.9rem; opacity: 0.9;">Imported for customization:</div>
                <div style="font-size: 1rem; margin-top: 0.2rem;">"${promptTitle}"</div>
            </div>
        </div>
    `;
    
    document.body.appendChild(notification);
    
    // Remove after 5 seconds with animation
    setTimeout(() => {
        notification.style.animation = 'slideOutRight 0.4s ease';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.remove();
            }
        }, 400);
    }, 5000);
}
        // Update your existing DOMContentLoaded to look like this:
document.addEventListener('DOMContentLoaded', function() {
    showWelcome();
    
    // Check for preset data from prompt library
    checkForPresetData();
});
    </script>
</body>
</html>
